<!DOCTYPE html>
<!-- saved from url=(0050)https://tiro-con-arco-ipn.onrender.com/atletas/new -->
<html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nuevo atleta | Sistema - Club de Tiro con Arco IPN</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>

  <header class="header">
    <div class="header-inner">
      <a class="brand" href="index.html">
        <img src="assets/ipn_logo.jpg" alt="IPN">
        <div class="brand-title">
          <b>Sistema de control deportivo</b>
          <span>Club de Tiro con Arco • Instituto Politécnico Nacional</span>
        </div>
      </a>

      <nav class="nav">
        <a href="index.html">Inicio</a>
        
            <a href="index.html" style="font-weight: bold; color: #800000;">Cerrar sesión</a>
        
      </nav>
    </div>
  </header>

  <main class="container">
    
      
    

    <div class="card">
      
  <h1>Nuevo atleta</h1>
  <p>Registro de atleta (miembro + rol atleta).</p>

  <form method="post">

    <h2>Datos del miembro</h2>

    <div style="margin-bottom:10px;">
      <label>Nombre *</label><br>
      <input name="nombre" type="text" required="" maxlength="120" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Apellido paterno</label><br>
      <input name="apellido_paterno" type="text" maxlength="80" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Apellido materno</label><br>
      <input name="apellido_materno" type="text" maxlength="80" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>CURP *</label><br>
      <input name="curp" type="text" required="" maxlength="18" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Correo</label><br>
      <input name="correo" type="email" maxlength="120" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Celular (10 dígitos)</label><br>
      <input name="celular" type="text" maxlength="20" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Edad</label><br>
      <input name="edad" type="number" min="8" max="90" style="max-width:160px;" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Alergias</label><br>
      <textarea name="alergias" rows="3"></textarea>
    </div>

    <h2>Datos del atleta</h2>

    <div style="margin-bottom:10px;">
      <label>¿Alumno IPN?</label>
      <input name="alumno_ipn" type="checkbox">
    </div>

    <div style="margin-bottom:10px;">
      <label>Boleta (obligatoria si es alumno IPN)</label><br>
      <input name="boleta" type="text" maxlength="20" value="">
    </div>

    <div style="margin-bottom:10px;">
      <label>Nivel *</label><br>
      <select name="nivel" id="nivel" required="" style="max-width:240px;">
        <option value="Inicial" selected="">Inicial</option>
        <option value="Intermedio">Intermedio</option>
        <option value="Avanzado">Avanzado</option>
      </select>
    </div>

    <div style="margin-bottom:10px;">
      <label>Clase *</label><br>
      <select name="clase_id" id="clase_id" required="" style="max-width:460px;"><option value="">-- Selecciona --</option><option value="1">ID 1 — L-M-V 16:00:00-18:00:00 (Coach 1)</option></select>
      <small style="display:block; opacity:.7; margin-top:6px;">
        Solo se muestran clases que coinciden con el nivel.
      </small>
    </div>

    <div class="actions">
      <button class="btn primary" type="submit">Guardar</button>
      <a class="btn" href="atletas.html">Cancelar</a>
    </div>

  </form>

  <script>
    async function cargarClases() {
      const nivel = document.getElementById("nivel").value;
      const sel = document.getElementById("clase_id");

      sel.innerHTML = `<option value="">Cargando...</option>`;

      try {
        const r = await fetch(`/api/clases?nivel=${encodeURIComponent(nivel)}`);
        const data = await r.json();

        if (!data.ok) {
          sel.innerHTML = `<option value="">No se pudieron cargar clases</option>`;
          return;
        }

        if (data.items.length === 0) {
          sel.innerHTML = `<option value="">No hay clases para ese nivel</option>`;
          return;
        }

        sel.innerHTML = `<option value="">-- Selecciona --</option>`;
        for (const it of data.items) {
          const opt = document.createElement("option");
          opt.value = it.clase_id;
          opt.textContent = it.label;
          sel.appendChild(opt);
        }

        // Si venías de un POST fallido, intenta re-seleccionar la clase que ya habías elegido
        const prev = "";
        if (prev) sel.value = prev;

      } catch (e) {
        sel.innerHTML = `<option value="">Error cargando clases</option>`;
      }
    }

    document.getElementById("nivel").addEventListener("change", cargarClases);
    window.addEventListener("DOMContentLoaded", cargarClases);
  </script>

    </div>

    <div class="footer">
      Sistema interno académico • IPN • Uso institucional
    </div>
  </main>


<div class="glasp-extension-toaster" style="display: block; width: 320px; margin: unset; padding: unset; border: unset; border-radius: unset; outline: unset; background-color: unset; box-shadow: unset; position: fixed; top: 40px; right: 24px; z-index: 9999;"><template shadowrootmode="open"><div class="glasp-extension" style="font-family: inherit;"></div></template></div></body><div class="glasp-extension" style="display: block; width: unset; margin: unset; padding: unset; border: unset; border-radius: unset; outline: unset; background-color: unset; box-shadow: unset; position: fixed; bottom: 16px; right: 16px; z-index: 9999;"><div class="glasp-extension" style="font-family: inherit;"></div></div></html>